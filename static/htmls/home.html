{% extends "base.html" %}

{% block content %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.js"></script>
<script>
    function postFile() {
        var formdata = new FormData();

        formdata.append('file1', $('#file1')[0].files[0]);

        var request = new XMLHttpRequest();

        request.upload.addEventListener('progress', function (e) {
            var file1Size = $('#file1')[0].files[0].size;

            if (e.loaded <= file1Size) {
                var percent = Math.round(e.loaded / file1Size * 100);
                $('#progress-bar-file1').width(percent + '%').html(percent + '%');
            }

            if(e.loaded == e.total){
                $('#progress-bar-file1').width(100 + '%').html(100 + '%');
            }
        });

        request.open('post', '/home');
        request.timeout = 45000;
        request.send(formdata);
    }
</script>
<form method="post" enctype="multipart/form-data" class="u-align-center">
    <h3>Upload a file:</h3>
    <input id="file1" type="file"/>
    <button type="button" onclick="postFile()">Upload File</button>
    <div class="alert alert-danger" role="alert">
        {{ error }}
    </div>
        <div class="progress-wrapper">
        <div id="progress-bar-file1" class="progress"></div>
    </div>
</form>

    {% endblock %}